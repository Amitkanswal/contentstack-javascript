(function(){
    if(!Contentstack) {
        alert('Please add Contentstack Library');
    } else {
        let clearAll = document.getElementById('all');
        let clearByContentType = document.getElementById('content_type');
        let clearByQuery = document.getElementById('query');
        let wrapper, Stack;

        function DOMCreation(entry, html) {
            if(entry) {
                html+='<div class="panel panel-default"><div class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#accordion" href="#'+entry.uid+'" aria-expanded="true" aria-controls="'+entry.uid+'">';
                html+=entry.title+'</a></h4></div><div id="'+entry.uid+'" class="panel-collapse collapse" role="tabpanel"><div class="panel-body">';
                html+=entry.url+' </div></div></div>';
            }
            return html;
        }

        function singleEntry (contentTypeUid, entryUid) {
            let contentTypeUid = contentTypeUid || "news"
            let entryUid = entryUid || "news_uid"

            Stack
                .ContentType(contentTypeUid)
                .Entry(entryUid)
                .fetch()
                .then(function(data) {
                    // result object with entry
                    let html = '<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">';
                    html = DOMCreation(data.toJSON(), html);
                    html+='</div>';
                    wrapper.innerHTML = html;
                }, function(err) {
                    console.info('News could not fetched.');
                });
        }

        function allEntries (contentTypeUid) {
            let contentTypeUid = contentTypeUid || "news";
            Stack
                .ContentType(contentTypeUid)
                .Query()
                .find()
                .then(function(data) {
                    if(data && data.length && data[0].length) {
                        let html = '<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">';
                        for(let i = 0, _i = data[0].length; i < _i; i++) {
                            html = DOMCreation(data[0][i].toJSON(), html);
                        }
                        html+='</div>';
                        wrapper.innerHTML = html;
                    } else {
                        console.info('News could not fetched.');
                    }
                }, function(err) {
                    console.info('Error : '+err);
                });
        }

        function allAssets () {
            Stack
                .Assets("blt2c43970eecc4d6cf")
                .fetch()
                .then(function (data) {
                    let _data =  data.getDownloadUrl('inline');
                }, function (err) {
                    // body...
                    console.info("Error: "+err);
                });
        }

        window.onload = function() {
            wrapper = document.getElementById('wrapper')
            Stack = Contentstack.Stack({'api_key': 'blt950d694ee9fce907', 'access_token': 'blt98a76e10ad802238', 'environment': 'development'})

            // get single the entry
            // singleEntry("source", "blt123something")

            // get all the entries
            // allEntries("source")

            // get all the assets
            allAssets();
        }
    }
}());